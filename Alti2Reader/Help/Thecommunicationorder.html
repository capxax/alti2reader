<html>
	
<head>
	<title>The communication order</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf8">
    <meta name="generator" content="HelpNDoc">
	<link type="text/css" rel="stylesheet" media="all" href="css/reset.css" />
	<link type="text/css" rel="stylesheet" media="all" href="css/base.css" />
	<link type="text/css" rel="stylesheet" media="all" href="css/hnd.css" />
	<!--[if lte IE 8]>
		<link type="text/css" rel="stylesheet" media="all" href="css/ielte8.css" />
	<![endif]-->
	<script type="text/javascript" src="js/chmRelative.js"></script>
</head>

<body>
	<div id="topic_header">
			<div id="topic_header_content">
				<h1>The communication order</h1>
				
				<div id="topic_breadcrumb">
					<a href="Altimastercommunicationprotocol.html">Altimaster communication protocol</a> &rsaquo;&rsaquo; </div>
				</div>
			<div id="topic_header_nav">
				<a href="Altimastercommunicationprotocol.html"><img src="img/arrow_up.png" alt="Parent"/></a>
				
				<a href="Altimastercommunicationprotocol.html"><img src="img/arrow_left.png" alt="Previous"/></a>
				
				<a href="Gettype0recordcommand.html"><img src="img/arrow_right.png" alt="Next"/></a>
				
				</div>
			<div class="clear"></div>
		</div>
	<div id="topic_content">
		
<p class="rvps6"><span class="rvts17">First of all you should open the COM port the device is connected to. I use for this propose </span><span class="rvts18">USB.DLL</span><span class="rvts17"> that can be found in the </span><span class="rvts18">NMU</span><span class="rvts17"> installation directory. This DLL is .NET assembly and can be easy added to your own program. To communicate by IRDA port use </span><span class="rvts18">IrDAComms.DLL</span><span class="rvts17"> which you can found in the same directory. These DLLs contains </span><span class="rvts18">_open</span><span class="rvts17"> function to open port.</span></p>
<p class="rvps6"><span class="rvts17">After COM port is opened make pause for about 10 seconds. Than send the first command.</span></p>
<p class="rvps6"><span class="rvts17">All commands have identical formats. The first byte contains the length of the command packet. The length does not include this first byte and the last byte which contains the checksum of the packet. Checksum is calculated as sum of packet bytes values by module of 256. This sum does not include the first length byte and the last checksum byte.</span></p>
<div class="rvps8"><table border="1" cellpadding="4" cellspacing="-1" style="border-width: 0px; border-collapse: collapse;">
<tr valign="top">
<td width="50" valign="top" style="border-width : 1px; border-color: #000000; border-style: solid;"><p class="rvps7"><span class="rvts18">BYTE 0</span></p>
</td>
<td width="347" valign="top" style="border-width : 1px; border-color: #000000; border-style: solid;"><p class="rvps7"><span class="rvts18">BYTES 1..N</span></p>
</td>
<td width="199" valign="top" style="border-width : 1px; border-color: #000000; border-style: solid;"><p class="rvps7"><span class="rvts18">BYTE N+1</span></p>
</td>
</tr>
<tr valign="top">
<td width="50" valign="top" style="border-width : 1px; border-color: #000000; border-style: solid;"><p class="rvps6"><span class="rvts17">Packet length</span></p>
</td>
<td width="347" valign="top" style="border-width : 1px; border-color: #000000; border-style: solid;"><p class="rvps6"><span class="rvts17">Command packet</span></p>
</td>
<td width="199" valign="top" style="border-width : 1px; border-color: #000000; border-style: solid;"><p class="rvps6"><span class="rvts17">Checksum of BYTES 1..N by module 256</span></p>
</td>
</tr>
</table>
</div>
<p class="rvps8"><span class="rvts17"><br></span></p>
<p class="rvps6"><span class="rvts17">I am not discover parameters of the write commands in case to do not damage my N3. So I know parameters only of tree commands: </span><a class="rvts19" href="Gettype0recordcommand.html">get type 0 record</a><span class="rvts17">, </span><a class="rvts19" href="Readmemorycommand.html">read memory</a><span class="rvts17"> and </span><a class="rvts19" href="Endcommunicationcommand.html">end communication</a><span class="rvts17"> commands.</span></p>
<p class="rvps8"><span class="rvts17"><br></span></p>
<p class="rvps2"><span class="rvts6">Created with the Personal Edition of HelpNDoc: </span><a class="rvts7" href="http://www.helpndoc.com">Easily create CHM Help documents</a></p>
</div>
	
	<div id="topic_footer">

			<div id="topic_footer_content">
				Copyright &copy; 2011 by Alexey Lobanov. All Rights Reserved.</div>
		</div>
	</body>
	
</html>

